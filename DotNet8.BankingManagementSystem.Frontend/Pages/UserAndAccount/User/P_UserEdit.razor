@page "/user-and-account/user/edit/{userCode}"

@if (_model is not null)
{
    <div class="max-w-2xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-500">
        <div class="text-center">
            <h1 class="text-4xl font-black text-base-content tracking-tight">Modify Profile</h1>
            <p class="text-base-content/60 mt-2 font-medium">Updating identity and locale for <span class="font-mono font-bold text-primary">@userCode</span>.</p>
        </div>

        <UiCard>
            <EditForm Model="@_model" OnValidSubmit="OnValidSubmit">
                <DataAnnotationsValidator />
                
                <div class="p-8 space-y-10">
                    <!-- Personal Section -->
                    <div class="space-y-6">
                        <div class="flex items-center gap-4">
                            <div class="w-8 h-8 rounded-lg bg-primary/10 text-primary flex items-center justify-center">
                                <i class="fa-solid fa-id-card text-xs"></i>
                            </div>
                            <h4 class="text-xs font-black uppercase tracking-widest opacity-60">Identity Credentials</h4>
                            <div class="h-px bg-base-300 flex-1"></div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">Legal Name</span></label>
                                <InputText @bind-Value="_model.FullName" class="input input-bordered focus:input-primary transition-all font-bold" placeholder="e.g. John Doe" />
                                <ValidationMessage For="@(() => _model.FullName)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>

                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">System Handle</span></label>
                                <InputText @bind-Value="_model.UserName" class="input input-bordered focus:input-primary transition-all font-bold" placeholder="e.g. johndoe_99" />
                                <ValidationMessage For="@(() => _model.UserName)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>

                            <div class="form-control w-full md:col-span-2">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">NRC Number</span></label>
                                <InputText @bind-Value="_model.Nrc" class="input input-bordered focus:input-primary transition-all font-mono font-bold" placeholder="e.g. 12/YAKANA(N)123456" />
                                <ValidationMessage For="@(() => _model.Nrc)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div class="space-y-6">
                        <div class="flex items-center gap-4">
                            <div class="w-8 h-8 rounded-lg bg-secondary/10 text-secondary flex items-center justify-center">
                                <i class="fa-solid fa-address-book text-xs"></i>
                            </div>
                            <h4 class="text-xs font-black uppercase tracking-widest opacity-60">Communication Context</h4>
                            <div class="h-px bg-base-300 flex-1"></div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">Electronic Mail</span></label>
                                <InputText @bind-Value="_model.Email" type="email" class="input input-bordered focus:input-primary transition-all font-bold" placeholder="john@example.com" />
                                <ValidationMessage For="@(() => _model.Email)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>

                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">Mobile Contact</span></label>
                                <InputText @bind-Value="_model.MobileNo" class="input input-bordered focus:input-primary transition-all font-bold" placeholder="09xxxxxxxxx" />
                                <ValidationMessage For="@(() => _model.MobileNo)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>

                            <div class="form-control w-full md:col-span-2">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">Physical Location</span></label>
                                <InputText @bind-Value="_model.Address" class="input input-bordered focus:input-primary transition-all font-bold" placeholder="Street, Building, Room..." />
                                <ValidationMessage For="@(() => _model.Address)" class="mt-1 text-[10px] text-error font-bold uppercase" />
                            </div>

                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">State / Division</span></label>
                                <select class="select select-bordered focus:select-primary transition-all font-bold" @onchange="(e) => ChangeState(e.Value?.ToString() ?? string.Empty)">
                                    <option value="">Select State</option>
                                    @if (_stateListResponseModel is not null && _stateListResponseModel.Data is not null)
                                    {
                                        @foreach (var item in _stateListResponseModel.Data)
                                        {
                                            <option value="@item.StateCode" selected="@(item.StateCode == _model.StateCode)">@item.StateName</option>
                                        }
                                    }
                                </select>
                            </div>

                            <div class="form-control w-full">
                                <label class="label"><span class="label-text font-bold text-[10px] uppercase tracking-widest opacity-60">Township Entity</span></label>
                                <InputSelect @bind-Value="@_model.TownshipCode" class="select select-bordered focus:select-primary transition-all font-bold">
                                    <option value="">Select Township</option>
                                    @if (_townshipListResponceModel is not null && _townshipListResponceModel.Data is not null)
                                    {
                                        @foreach (var item in _townshipListResponceModel.Data)
                                        {
                                            <option value="@item.TownshipCode">@item.TownshipName</option>
                                        }
                                    }
                                </InputSelect>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-8 pt-0 flex items-center justify-end gap-4">
                    <button type="button" class="btn btn-ghost" @onclick="@(() => NavigationManager.NavigateTo("/user-and-account/user"))">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary shadow-lg shadow-primary/20">
                        Commit Variations
                    </button>
                </div>
            </EditForm>
        </UiCard>
    </div>
}

@page "/"

<PageTitle>Dashboard | IBanking</PageTitle>

@if (IsLoading)
{
    <div class="flex items-center justify-center min-h-[400px]">
        <div class="flex flex-col items-center gap-4">
            <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"></div>
            <p class="text-muted-foreground text-sm font-medium">Gathering financial insights...</p>
        </div>
    </div>
}
else
{
    <div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-500">
        <UiPageHeader Title="Dashboard" Subtitle="Welcome back! Here's what's happening today.">
            <Actions>
                <UiButton Variant="UiButtonVariant.Outline" Size="UiButtonSize.Sm" OnClick="LoadDashboardData">
                    <i class="fa-solid fa-rotate mr-2 text-muted-foreground"></i>
                    Refresh
                </UiButton>
                <UiButton Variant="UiButtonVariant.Default" Size="UiButtonSize.Sm" OnClick="@(() => NavigationManager.NavigateTo("/transaction/transfer"))">
                    <i class="fa-solid fa-plus mr-2 opacity-70"></i>
                    New Transfer
                </UiButton>
            </Actions>
        </UiPageHeader>

        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <UiCard Class="relative overflow-hidden group">
                <div class="absolute right-0 top-0 w-24 h-24 bg-primary/5 rounded-full -mr-8 -mt-8 transition-transform group-hover:scale-110"></div>
                <div class="p-6 flex flex-row items-center justify-between space-y-0 pb-2">
                    <h3 class="text-xs font-bold uppercase tracking-wider text-muted-foreground">Global Balance</h3>
                    <div class="p-2 bg-primary/10 rounded-lg">
                        <i class="fa-solid fa-vault text-primary text-[10px]"></i>
                    </div>
                </div>
                <div class="p-6 pt-0">
                    <div class="text-2xl font-bold tracking-tight">@TotalBalance.ToString("N0") <span class="text-[10px] text-muted-foreground font-medium uppercase ml-1">MMK</span></div>
                </div>
            </UiCard>

            <UiCard Class="relative overflow-hidden group">
                <div class="absolute right-0 top-0 w-24 h-24 bg-blue-500/5 rounded-full -mr-8 -mt-8 transition-transform group-hover:scale-110"></div>
                <div class="p-6 flex flex-row items-center justify-between space-y-0 pb-2">
                    <h3 class="text-xs font-bold uppercase tracking-wider text-muted-foreground">Active Accounts</h3>
                    <div class="p-2 bg-blue-500/10 rounded-lg">
                        <i class="fa-solid fa-id-card-clip text-blue-600 text-[10px]"></i>
                    </div>
                </div>
                <div class="p-6 pt-0">
                    <div class="text-2xl font-bold tracking-tight">@TotalAccounts</div>
                </div>
            </UiCard>

            <UiCard Class="relative overflow-hidden group">
                <div class="absolute right-0 top-0 w-24 h-24 bg-emerald-500/5 rounded-full -mr-8 -mt-8 transition-transform group-hover:scale-110"></div>
                <div class="p-6 flex flex-row items-center justify-between space-y-0 pb-2">
                    <h3 class="text-xs font-bold uppercase tracking-wider text-muted-foreground">Total Customers</h3>
                    <div class="p-2 bg-emerald-500/10 rounded-lg">
                        <i class="fa-solid fa-user-group text-emerald-600 text-[10px]"></i>
                    </div>
                </div>
                <div class="p-6 pt-0">
                    <div class="text-2xl font-bold tracking-tight">@TotalCustomers</div>
                </div>
            </UiCard>

            <UiCard Class="relative overflow-hidden group">
                <div class="absolute right-0 top-0 w-24 h-24 bg-amber-500/5 rounded-full -mr-8 -mt-8 transition-transform group-hover:scale-110"></div>
                <div class="p-6 flex flex-row items-center justify-between space-y-0 pb-2">
                    <h3 class="text-xs font-bold uppercase tracking-wider text-muted-foreground">Recent Activity</h3>
                    <div class="p-2 bg-amber-500/10 rounded-lg">
                        <i class="fa-solid fa-receipt text-amber-600 text-[10px]"></i>
                    </div>
                </div>
                <div class="p-6 pt-0">
                    <div class="text-2xl font-bold tracking-tight">@RecentTransactionsCount</div>
                </div>
            </UiCard>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Recent Transactions -->
            <UiCard Class="lg:col-span-2">
                <div class="flex flex-col space-y-1.5 p-6 pb-4">
                    <h3 class="ui-card-title">Recent Activity</h3>
                    <p class="ui-card-description">Latest transactions across the system.</p>
                </div>
                <div class="p-0 overflow-hidden">
                    @if (!RecentTransactions.Any())
                    {
                        <div class="py-12 text-center text-muted-foreground">
                            <i class="fa-solid fa-inbox text-2xl mb-2 block opacity-20"></i>
                            <p class="text-xs font-medium">No recent transaction data available.</p>
                        </div>
                    }
                    else
                    {
                        <div class="overflow-auto">
                            <table class="ui-table">
                                <thead class="ui-table-header">
                                    <tr class="ui-table-row">
                                        <th class="ui-table-head">Flow</th>
                                        <th class="ui-table-head">Date & Time</th>
                                        <th class="ui-table-head text-right pr-6">Amount (MMK)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var txn in RecentTransactions)
                                    {
                                        <tr class="ui-table-row group">
                                            <td class="ui-table-cell">
                                                <div class="flex flex-col gap-0.5">
                                                    <span class="text-xs font-mono font-bold">@txn.FromAccountNo</span>
                                                    <div class="flex items-center gap-1.5 ml-2">
                                                        <i class="fa-solid fa-arrow-right text-[8px] text-muted-foreground/50"></i>
                                                        <span class="text-[10px] text-muted-foreground font-medium">@txn.ToAccountNo</span>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="ui-table-cell">
                                                <div class="flex flex-col">
                                                    <span class="text-xs font-medium text-slate-700">@txn.TransactionDate.ToString("dd MMM yyyy")</span>
                                                    <span class="text-[10px] text-muted-foreground font-bold tracking-tight">@txn.TransactionDate.ToString("hh:mm tt")</span>
                                                </div>
                                            </td>
                                            <td class="ui-table-cell text-right pr-6 font-bold font-mono tabular-nums text-xs">
                                                @txn.Amount.ToString("N0")
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        <div class="p-4 border-t border-border bg-muted/5 flex justify-end">
                            <UiButton Variant="UiButtonVariant.Ghost" Size="UiButtonSize.Sm" OnClick="@(() => NavigationManager.NavigateTo("/report/transaction-history"))">
                                <span class="mr-2">Full History</span>
                                <i class="fa-solid fa-arrow-right text-[10px]"></i>
                            </UiButton>
                        </div>
                    }
                </div>
            </UiCard>

            <!-- Quick Actions & Insights -->
            <div class="space-y-4">
                <UiCard>
                    <div class="p-6 pb-2">
                        <h3 class="text-sm font-semibold tracking-tight">Direct Actions</h3>
                    </div>
                    <div class="p-6 pt-2 space-y-2">
                        <UiButton Variant="UiButtonVariant.Outline" Class="w-full justify-start text-xs h-11" OnClick="@(() => NavigationManager.NavigateTo("/transaction/deposit"))">
                            <div class="w-8 h-8 rounded-md bg-primary/10 text-primary flex items-center justify-center mr-3">
                                <i class="fa-solid fa-plus text-xs"></i>
                            </div>
                            <div class="text-left">
                                <p class="font-bold">Cash Deposit</p>
                            </div>
                        </UiButton>
                        <UiButton Variant="UiButtonVariant.Outline" Class="w-full justify-start text-xs h-11" OnClick="@(() => NavigationManager.NavigateTo("/transaction/withdraw"))">
                            <div class="w-8 h-8 rounded-md bg-destructive/10 text-destructive flex items-center justify-center mr-3">
                                <i class="fa-solid fa-minus text-xs"></i>
                            </div>
                            <div class="text-left">
                                <p class="font-bold">Withdrawal</p>
                            </div>
                        </UiButton>
                    </div>
                </UiCard>

                <div class="bg-primary text-primary-foreground rounded-lg p-6 shadow-sm border border-primary-700 relative overflow-hidden">
                    <div class="absolute -top-12 -right-12 w-32 h-32 bg-white/10 rounded-full blur-3xl"></div>
                    <div class="relative z-10 space-y-3">
                        <h4 class="text-xs font-bold flex items-center gap-2">
                            <i class="fa-solid fa-lightbulb opacity-70"></i>
                            System Insight
                        </h4>
                        <p class="text-[11px] font-medium leading-relaxed opacity-90">
                            Regularly auditing your accounts helps maintain system integrity and security.
                        </p>
                        <UiButton Variant="UiButtonVariant.Outline" Class="w-full text-[10px] font-bold h-8 border-primary-foreground/20 bg-primary-foreground/10 hover:bg-primary-foreground/20 text-primary-foreground">
                            LEARN MORE
                        </UiButton>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
<div class="flex items-center justify-center mt-8">
    <div class="join bg-base-100 shadow-sm border border-base-300">
        <button class="join-item btn btn-sm btn-ghost @(PageNo <= 1 ? "btn-disabled" : "")" @onclick="GoToFirst">
            <i class="fa-solid fa-angles-left text-[10px]"></i>
        </button>
        
        <button class="join-item btn btn-sm btn-ghost @(PageNo <= 1 ? "btn-disabled" : "")" @onclick="GoToPrevious">
            <i class="fa-solid fa-chevron-left text-[10px]"></i>
        </button>

        @for (int i = StartPage; i <= EndPage; i++)
        {
            var pageIndex = i;
            <button class="join-item btn btn-sm @(PageNo == i ? "btn-primary" : "btn-ghost")" @onclick="() => SelectPage(pageIndex)">
                @i
            </button>
        }

        <button class="join-item btn btn-sm btn-ghost @(PageNo >= PageCount ? "btn-disabled" : "")" @onclick="GoToNext">
            <i class="fa-solid fa-chevron-right text-[10px]"></i>
        </button>
        
        <button class="join-item btn btn-sm btn-ghost @(PageNo >= PageCount ? "btn-disabled" : "")" @onclick="GoToLast">
            <i class="fa-solid fa-angles-right text-[10px]"></i>
        </button>
    </div>
</div>

@code {
    [Parameter] public int PageNo { get; set; }
    [Parameter] public int PageCount { get; set; }
    [Parameter] public EventCallback<int> SelectedChanged { get; set; }

    private int VisiblePages = 5;

    private int StartPage => Math.Max(1, PageNo - (VisiblePages / 2));
    private int EndPage => Math.Min(PageCount, StartPage + VisiblePages - 1);

    private async Task SelectPage(int page) => await SelectedChanged.InvokeAsync(page);
    private async Task GoToFirst() => await SelectPage(1);
    private async Task GoToLast() => await SelectPage(PageCount);
    private async Task GoToPrevious() => await SelectPage(Math.Max(1, PageNo - 1));
    private async Task GoToNext() => await SelectPage(Math.Min(PageCount, PageNo + 1));
}
